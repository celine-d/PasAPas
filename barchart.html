<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <style>
    body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0; }
    
    path { 
    fill: none;
}
   div.tooltip {
        color: #222;
        background-color: #fff;
        padding: .5em;
        text-shadow: #f5f5f5 0 1px 0;
        border-radius: 2px;
        opacity: 0.9;
        position: absolute;
    	}  
    
    .hidden {
        display: none;
    	}
  </style>
</head>

<body>
    <form>
  Année :
      <label><input type="radio" name="annee" value="all" checked> Tout</label>
    <label><input type="radio" name="annee" value="seize"> 2016</label>
      <label><input type="radio" name="annee" value="dix_sept"> 2017</label>
    <label><input type="radio" name="annee" value="dix_huit" > 2018</label>
    <label><input type="radio" name="annee" value="dix_neuf"> 2019</label>  
  </form>
  
      <form>
  Distance référence :
      <label><input type="radio" name="distance_ref" value="saint_etienne" checked> Lyon-Saint-Étienne : 63 km</label>
      <label><input type="radio" name="distance_ref" value="clermont_ferrand"> Lyon-Clermont-Ferrand : 164 km</label>
      <label><input type="radio" name="distance_ref" value="montpellier"> Lyon-Montpellier : 301 km</label>
  </form>
  <script>
    
	var margin = {top: 20, right: 10, bottom: 20, left: 20};
    
 	var tooltip = d3.select("body").append("div") 
    	.attr("class", "tooltip")       
      .style("opacity", 0);
  
  var Arrondi = d3.format(".0f"); 
  var Arrondi1 = d3.format(".1f"); 
    
    var formatAnnee = d3.timeFormat("%Y");
    var formatMois = d3.timeFormat("%B");
    var formatdate = d3.timeFormat("%B %Y");
    

    
	var width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;
    
	var svg = d3.select("body").append("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  	// parse the date / time
		var parseDate = d3.timeParse("%m_%Y"); //pour convertir dans le format date

    //2. Générer les données
    d3.csv('https://raw.githubusercontent.com/celine-d/PasAPas/master/Health%20Data_moisdistance3.csv',function(error,data){
      data.forEach(function(d){
        d.Mois=parseDate(d.Mois); //mettre sous une forme de date année les données
        d.mois=formatdate(d.Mois)
        d.distance=+d.Distance;
      });

    var x = d3.scaleLinear()
          .range([0, width-70])
    			.domain([1,500]);
      
    var y_mois=d3.scaleBand()
    .domain(data.map(function(d){
            return d.mois;
          })) 
    .rangeRound([400,0])//sur espace graphique
    
     
    var xAxis=d3.axisBottom()
    .scale(x)
    
    var MoisAxis= d3.axisLeft()
  	.scale(y_mois);
      
      
    var color = d3.scaleOrdinal(d3.schemeCategory10) // échelle de couleur
    
    svg.selectAll(".bar")
      .data(data)
      .enter().append("rect")
      .attr("class", "bar")
    	.style("fill", "grey")
      .attr('transform','translate(70,' + 0 + ')')
      .attr("width", function(d) {return x(d.distance)*100/63; } )
      .attr("y", function(d) { return y_mois(d.mois); })
      .attr("height", y_mois.bandwidth()/1.2);


  
function draw_all() {

}

function draw_seize() {

}

function draw_sept() {

}
      
function draw_huit() {
 
}

function draw_neuf() {

}
      
function size_stetienne() {
  	x.domain([1,500])
    svg.selectAll(".bar")
      .attr("class", "bar")
    	.style("fill", "grey")
      .attr('transform','translate(70,' + 0 + ')')
      .attr("width", function(d) {return x(d.distance)*100/63; } )
      .attr("y", function(d) { return y_mois(d.mois); })
      .attr("height", y_mois.bandwidth()/1.2);
}
      
function size_clermontferrand() {
	x.domain([1,200])
    svg.selectAll(".bar")
      .attr("class", "bar")
    	.style("fill", "grey")
      .attr('transform','translate(70,' + 0 + ')')
      .attr("width", function(d) {return x(d.distance)*100/164; } )
      .attr("y", function(d) { return y_mois(d.mois); })
      .attr("height", y_mois.bandwidth()/1.2);
}
      
function size_montpellier() {
x.domain([1,100])
    svg.selectAll(".bar")
      .attr("class", "bar")
    	.style("fill", "grey")
      .attr('transform','translate(70,' + 0 + ')')
      .attr("width", function(d) {return x(d.distance)*100/301; } )
      .attr("y", function(d) { return y_mois(d.mois); })
      .attr("height", y_mois.bandwidth()/1.2);
}
 		 svg.append('g') //groupe dans lequel on met tout pour créer un axe
  	.attr('transform', 'translate(70,' + 400 + ')') //positions (x,y)
  	.attr('class', 'x axis')
  	.call(xAxis)
 
    
     svg.append('g') //groupe dans lequel on met tout pour créer un axe
    .attr('transform','translate(70,' + 0 + ')')
  	.attr('class', 'y axis')
  	.call(MoisAxis)
 

// définition des relations label/fonction
d3.select("input[value=\"all\"]").on("click", draw_all);
d3.select("input[value=\"seize\"]").on("click", draw_seize);
d3.select("input[value=\"dix_sept\"]").on("click", draw_sept);
d3.select("input[value=\"dix_huit\"]").on("click", draw_huit);
d3.select("input[value=\"dix_neuf\"]").on("click", draw_neuf);
d3.select("input[value=\"saint_etienne\"]").on("click", size_stetienne);
d3.select("input[value=\"clermont_ferrand\"]").on("click", size_clermontferrand);
d3.select("input[value=\"montpellier\"]").on("click", size_montpellier);

   
    }); 
  </script>
</body>
